# Log4j Exploit Detection -- Microsoft Sentinel Overview

This document provides a detailed overview of the Log4j (Log4Shell)
Exploit Detection implementation performed using Microsoft Sentinel.\
The goal of this task was to deploy a detection solution, configure an
analytics rule, and establish automated incident handling for monitoring
Log4j exploitation attempts across Azure environments.

------------------------------------------------------------------------

## üìå Objective

To create a functional threat detection pipeline by:

-   Installing the **Log4j Vulnerability Detection** solution\
-   Deploying the **Log4Shell IP IOC scheduled analytics rule**\
-   Customizing detection logic with **KQL**\
-   Adding contextual details to alerts\
-   Automating incident tagging for faster triage

This ensures real-time visibility into potential exploitation attempts
targeting Log4j vulnerabilities.

------------------------------------------------------------------------

## üõ† Step-by-Step Implementation

### 1Ô∏è‚É£ Install Log4j Vulnerability Detection Solution

The solution was installed directly from the **Microsoft Sentinel
Content Hub**.

**Key actions:**

-   Navigated to *Microsoft Sentinel ‚Üí Content Hub*\
-   Searched for **Log4j Vulnerability Detection**\
-   Installed the solution via Defender portal\
-   Synced components (rule templates, hunting queries, data connectors)

This installation provides pre-built intelligence and threat indicators
for Log4Shell.

------------------------------------------------------------------------

### 2Ô∏è‚É£ Locate the Log4Shell IP IOC Analytics Rule Template

After installation:

-   Opened *Sentinel ‚Üí Analytics ‚Üí Rule templates*\
-   Searched for **Log4j**\
-   Selected **Log4j vulnerability exploit aka Log4Shell IP IOC**

This template includes a ready-made KQL query leveraging threat
intelligence and network indicators.

------------------------------------------------------------------------

### 3Ô∏è‚É£ Create the Scheduled Analytics Rule

Using the template wizard:

#### **General Settings**

-   **Name:** Log4j vulnerability exploit aka Log4Shell IP IOC\
-   **Rule type:** Scheduled\
-   **Status:** Enabled

#### **Set Rule Logic**

-   Reviewed and validated the preconfigured KQL query\
-   Added *timestamp* to **Custom Details** for enriched context\
-   Updated **Alert Name Format** to include timestamp

#### **Incident Settings**

-   Default incident creation settings were retained

------------------------------------------------------------------------

### 4Ô∏è‚É£ Configure Automated Response

Automation was added to enhance SOC triage efficiency:

-   Created a new automation rule\
-   **Name:** Log4J vulnerability exploit detection\
-   **Action:** Add tag\
-   **Tag added:** `Log4J exploit`

This supports improved filtering, grouping, and workflow handling.

------------------------------------------------------------------------

### 5Ô∏è‚É£ Final Review & Activation

-   Reviewed full rule configuration\
-   Verified threshold settings, entity mapping, and KQL logic\
-   Saved and activated the rule

The rule now actively scans incoming logs for indicators of Log4j
exploit activity.

------------------------------------------------------------------------

## üìä Outcome

The Log4j detection pipeline delivers:

‚úî Automated detection of Log4Shell exploitation attempts\
‚úî Enriched incidents with custom alert details\
‚úî Streamlined triage using automation rule tags\
‚úî Threat intelligence integration via IP indicators\
‚úî Real-time visibility across Azure workloads

This capability strengthens cloud threat detection, SOC response
efficiency, and overall defensive posture.

------------------------------------------------------------------------

## üìÅ Related Files

-   **Analytics-Rule-KQL.txt** -- Contains the KQL logic used in the
    detection rule\
-   **Automation-Rule-Config.md** -- Details automation workflow\
-   **Notes.md** -- Additional observations and learnings
